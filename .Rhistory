scale_fill_manual(values = type_colors) +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
PDR_summary_combined <- PDR_summary %>%
mutate(participant = as.character(participant)) %>%
bind_rows(
PDR_summary %>%
group_by(type) %>%
summarise(mean_response = mean(mean_response, na.rm = TRUE)) %>%
mutate(participant = "All")
) %>%
bind_rows(
tibble(participant = " ", mean_response = NA, type = NA)  # spacer
)
# Factor order: sorted participants, spacer, then All
participant_levels <- c(sort(unique(PDR_summary$participant)), " ", "All")
PDR_summary_combined$participant <- factor(PDR_summary_combined$participant,
levels = participant_levels)
n_participants <- length(unique(PDR_summary$participant))
# Colors for types
type_colors <- RColorBrewer::brewer.pal(n = length(unique(PDR_summary$type)), "Set1")
names(type_colors) <- unique(PDR_summary$type)
# Plot
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, colour = type, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(position = position_dodge(width = 0.8), alpha = 0.6) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Colors for type
scale_colour_manual(values = type_colors) +
scale_fill_manual(values = type_colors) +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
# Create a dummy spacer row
PDR_summary_combined <- PDR_summary %>%
mutate(participant = as.character(participant)) %>%
bind_rows(
PDR_summary %>%
mutate(participant = "All")
) %>%
bind_rows(
tibble(participant = " ", mean_response = NA)  # spacer
)
# Factor order: sorted participants, spacer, then All
PDR_summary_combined$participant <- factor(
PDR_summary_combined$participant,
levels = c(sort(unique(PDR_summary$participant)), " ", "All")
)
# Colors for types
type_colors <- RColorBrewer::brewer.pal(n = length(unique(PDR_summary$type)), "Set1")
names(type_colors) <- unique(PDR_summary$type)
# Plot
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, colour = type, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(position = position_dodge(width = 0.8), alpha = 0.6) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Colors for type
scale_colour_manual(values = type_colors) +
scale_fill_manual(values = type_colors) +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(position = position_dodge(width = 0.8), alpha = 0.6) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(position = position_dodge(width = 0.8), width = 0.1, alpha = 0.6) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(position = width = 0.1, alpha = 0.6) +
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points
geom_jitter(width = 0.1, alpha = 0.6) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.8,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
View(PDR_summary_combined)
PDR_summary_combined <- PDR_summary %>%
mutate(participant = as.character(participant)) %>%
bind_rows(
PDR_summary %>%
mutate(participant = "All")
) %>%
bind_rows(
tibble(participant = " ", mean_response = NA)  # spacer
)
# Factor order: sorted participants, spacer, then All
PDR_summary_combined$participant <- factor(
PDR_summary_combined$participant,
levels = c(sort(unique(PDR_summary$participant)), " ", "All")
)
n_participants <- length(unique(PDR_summary$participant))
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.8,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
scale_fill_manual(values = RColorBrewer::brewer.pal(2, "Set1"), na.value = NA) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.8), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.8,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.5)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.7), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.7,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
scale_fill_manual(na.translate = F) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.28)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.7), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.7,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.28)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.7), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.7,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.3)
)
PDR_summary_combined <- PDR_summary %>%
mutate(participant = as.character(participant)) %>%
bind_rows(
PDR_summary %>%
mutate(participant = "All")
) %>%
bind_rows(
tibble(participant = " ", mean_response = NA, type = 'noise')  # spacer
)
# Factor order: sorted participants, spacer, then All
PDR_summary_combined$participant <- factor(
PDR_summary_combined$participant,
levels = c(sort(unique(PDR_summary$participant)), " ", "All")
)
n_participants <- length(unique(PDR_summary$participant))
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = type)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.7), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.7,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.3)
)
ggplot(PDR_summary_combined, aes(x = participant, y = mean_response, fill = segment)) +
geom_hline(yintercept = 0, colour = "black", linetype = "dashed") +
# Boxplots
geom_boxplot(position = position_dodge(width = 0.7), width = 0.6, outlier.shape = NA) +
# Points with jitter + dodge
geom_point(
position = position_jitterdodge(
dodge.width = 0.7,  # same as boxplot dodge
jitter.width = 0.1   # horizontal jitter within each type
),
alpha = 0.6
) +
# Labels
labs(x = "Participant", y = "Mean response") +
# Bold "All" label
scale_x_discrete(labels = c(sort(unique(PDR_summary$participant)), "", "<b>All participants</b>")) +
theme_bw(base_size = 15) +
theme(
panel.grid = element_blank(),
axis.title = element_text(face = "bold"),
legend.position = "top",
axis.text.x = element_markdown(),
axis.title.x = element_text(hjust = 0.3)
)
ggplot(headturn_summary[headturn_summary$participant %in% c('inf2', 'inf3', 'inf4'),],
aes(x = test_type, y = median_time, fill = test_type)) +
geom_bar(stat = "identity") +
geom_point(data = headturn_test[headturn_test$participant %in% c('inf2', 'inf3', 'inf4') & headturn_test$looking_time_ms > 1000,],
aes(y = looking_time_ms), alpha = 0.3) +
labs(x = "", y = "Median looking time (ms)") +
theme_minimal(base_size = 11) +
facet_wrap(vars(participant), ncol = 3) +
theme(legend.position = 'none') +
scale_x_discrete(labels = c(
"TT_FAMILIAR"       = "Familiar",
"TT_UNGRAMMATICAL"  = "Un-\ngrammatical",
"TT_NEW_GRAMMATICAL"= "New\nGrammatical"
))
headturn_test <- read.csv("./data/raw/headturn/headturn-test-1.csv", skip = 1, sep = ";")
# Add the general participant labels
# ppid == 'pilot1' ~ 'inf1', and ppid == 'inf_pilot5' ~ 'inf5' are not included
headturn_test <- headturn_test %>%
mutate(participant = case_when(ppid == 'pilot1' ~ 'inf1',
ppid == 'inf_pilot2' ~ 'inf2',
ppid == 'test_pilot1' ~ 'inf3',
ppid == 'inf_pilot4' ~ 'inf4',
ppid == 'inf_pilot5' ~ 'inf5')) %>%
filter(!is.na(participant)) %>%
mutate(test_type = factor(test_type, levels = c("TT_FAMILIAR", "TT_UNGRAMMATICAL", "TT_NEW_GRAMMATICAL")))
ggplot(headturn_summary[headturn_summary$participant %in% c('inf2', 'inf3', 'inf4'),],
aes(x = test_type, y = median_time, fill = test_type)) +
geom_bar(stat = "identity") +
geom_point(data = headturn_test[headturn_test$participant %in% c('inf2', 'inf3', 'inf4') & headturn_test$looking_time_ms > 1000,],
aes(y = looking_time_ms), alpha = 0.3) +
labs(x = "", y = "Median looking time (ms)") +
theme_minimal(base_size = 11) +
facet_wrap(vars(participant), ncol = 3) +
theme(legend.position = 'none') +
scale_x_discrete(labels = c(
"TT_FAMILIAR"       = "Familiar",
"TT_UNGRAMMATICAL"  = "Un-\ngrammatical",
"TT_NEW_GRAMMATICAL"= "New\nGrammatical"
))
headturn_test <- read.csv("./data/raw/headturn/headturn-test-1.csv", skip = 1, sep = ";")
# Add the general participant labels
# ppid == 'pilot1' ~ 'inf1', and ppid == 'inf_pilot5' ~ 'inf5' are not included
headturn_test <- headturn_test %>%
mutate(participant = case_when(ppid == 'pilot1' ~ 'inf1',
ppid == 'inf_pilot2' ~ 'inf2',
ppid == 'test_pilot1' ~ 'inf3',
ppid == 'inf_pilot4' ~ 'inf4',
ppid == 'inf_pilot5' ~ 'inf5')) %>%
dplyr::filter(!is.na(participant)) %>%
mutate(test_type = factor(test_type, levels = c("TT_FAMILIAR", "TT_UNGRAMMATICAL", "TT_NEW_GRAMMATICAL")))
# Precompute median per participant and test type
headturn_summary <- headturn_test %>%
group_by(participant, test_type) %>%
dplyr::filter(looking_time_ms > 1000) %>%
summarise(median_time = median(looking_time_ms, na.rm = TRUE),
.groups = "drop")
ggplot(headturn_summary[headturn_summary$participant %in% c('inf2', 'inf3', 'inf4'),],
aes(x = test_type, y = median_time, fill = test_type)) +
geom_bar(stat = "identity") +
geom_point(data = headturn_test[headturn_test$participant %in% c('inf2', 'inf3', 'inf4') & headturn_test$looking_time_ms > 1000,],
aes(y = looking_time_ms), alpha = 0.3) +
labs(x = "", y = "Median looking time (ms)") +
theme_minimal(base_size = 11) +
facet_wrap(vars(participant), ncol = 3) +
theme(legend.position = 'none') +
scale_x_discrete(labels = c(
"TT_FAMILIAR"       = "Familiar",
"TT_UNGRAMMATICAL"  = "Un-\ngrammatical",
"TT_NEW_GRAMMATICAL"= "New\nGrammatical"
))
ggplot(headturn_summary[headturn_summary$participant %in% c('inf2', 'inf3', 'inf4'),],
aes(x = test_type, y = median_time, fill = test_type)) +
geom_bar(stat = "identity") +
geom_point(data = headturn_test[headturn_test$participant %in% c('inf2', 'inf3', 'inf4') & headturn_test$looking_time_ms > 1000,],
aes(y = looking_time_ms), alpha = 0.3) +
labs(x = "", y = "Median looking time (ms)") +
theme_bw(base_size = 15) +
facet_wrap(vars(participant), ncol = 3) +
theme(legend.position = 'none') +
scale_x_discrete(labels = c(
"TT_FAMILIAR"       = "Familiar",
"TT_UNGRAMMATICAL"  = "Un-\ngrammatical",
"TT_NEW_GRAMMATICAL"= "New\nGrammatical"
))
View(headturn_summary)
headturn_test <- read.csv("./data/raw/headturn/headturn-test-1.csv", skip = 1, sep = ";")
# Add the general participant labels
# ppid == 'pilot1' ~ 'inf1', and ppid == 'inf_pilot5' ~ 'inf5' are not included
headturn_test <- headturn_test %>%
mutate(participant = case_when(ppid == 'pilot1' ~ 'inf1',
ppid == 'inf_pilot2' ~ 'inf2',
ppid == 'test_pilot1' ~ 'inf3',
ppid == 'inf_pilot4' ~ 'inf4',
ppid == 'inf_pilot5' ~ 'inf5')) %>%
dplyr::filter(!is.na(participant)) %>%
mutate(test_type = factor(test_type, levels = c("TT_FAMILIAR", "TT_UNGRAMMATICAL", "TT_NEW_GRAMMATICAL")))
# Precompute median per participant and test type
headturn_summary <- headturn_test %>%
group_by(participant, test_type) %>%
dplyr::filter(looking_time_ms > 1000) %>%
summarise(median_time = median(looking_time_ms, na.rm = TRUE),
mean_time = mean(looking_time_ms, na.rm = TRUE),
.groups = "drop")
ggplot(headturn_summary[headturn_summary$participant %in% c('inf2', 'inf3', 'inf4'),],
aes(x = test_type, y = mean_time, fill = test_type)) +
geom_bar(stat = "identity") +
geom_point(data = headturn_test[headturn_test$participant %in% c('inf2', 'inf3', 'inf4') & headturn_test$looking_time_ms > 1000,],
aes(y = looking_time_ms), alpha = 0.3) +
labs(x = "", y = "Median looking time (ms)") +
theme_bw(base_size = 15) +
facet_wrap(vars(participant), ncol = 3) +
theme(legend.position = 'none') +
scale_x_discrete(labels = c(
"TT_FAMILIAR"       = "Familiar",
"TT_UNGRAMMATICAL"  = "Un-\ngrammatical",
"TT_NEW_GRAMMATICAL"= "New\nGrammatical"
))
dm$stimulus
324-185
115+13+7+11+17
115+13+7+11+17+80
# Trial exclusion
list_inclusion <- list(baseline = which(dm$bl_incl == 1),
gaze = which(dm$gaze_incl == 1),
data_loss = which(dm$trial_incl == 1))
ggVennDiagram(list_inclusion)
View(list_inclusion)
library(ggVennDiagram)
ggVennDiagram(list_inclusion)
View(headturn_summary)
View(headturn_test)
table(headturn_test$participant, headturn_test$looking_time < 1)
table(headturn_test$sound_direction[headturn_test$participant == "inf3"], headturn_test$looking_time[headturn_test$participant == "inf3"] < 1)
table(headturn_test$id[headturn_test$participant == "inf3"], headturn_test$looking_time[headturn_test$participant == "inf3"] < 1)
headturn_summary
