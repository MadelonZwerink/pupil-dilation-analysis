nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- ggplot(dm_long, aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
dm_long$stim_type <- as.factor(dm_long$stim_type, ordered = T, levels = c('emphasized_noise', 'emphasized', 'functional_noise', 'functional'))
dm_long$stim_type <- factor(dm_long$stim_type, ordered = T, levels = c('emphasized_noise', 'emphasized', 'functional_noise', 'functional'))
View(dm)
View(dm_long)
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'functional' | stim_type == 'functional_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- ggplot(dm_long, aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
View(stim_tvalues)
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'functional' | stim_type == 'functional_noise')) %>%
ggplot(aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
rlang::last_trace()
table(dm$stim_type)
table(dm_long$timepoint[dm_long$stim_type == 'emphasized_noise'])
table(dm_long$pupil[dm_long$stim_type == 'emphasized_noise' & dm_long$timepoint == 1])
table(dm_long$pupil[dm_long$stim_type == 'emphasized' & dm_long$timepoint == 1])
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
dm_long$stim_grouped <- factor(dm_long$stim_grouped, ordered=T, levels = c('noise', 'familiarization'))
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_grouped + (1 + stim_grouped | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint)
dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest()
rlang::last_trace()
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_grouped + (1 + stim_grouped), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lm(pupil ~ stim_grouped, data = .x)),
results = map(model, ~ broom::tidy(.x))
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
ggplot(aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
models_by_time <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'functional' | stim_type == 'functional_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'functional' | stim_type == 'functional_noise')) %>%
ggplot(aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
models_by_time <- dm_long %>%
filter(timepoint <= 494 &
trialnr <= 49 &
(stim_type == 'functional' | stim_type == 'functional_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type + (1 + stim_type | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'functional' | stim_type == 'functional_noise')) %>%
ggplot(aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
models_by_time <- dm_long %>%
filter(timepoint <= 494 &
trialnr <= 49 &
(stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lm(pupil ~ stim_type, data = .x)),
results = map(model, ~ broom::tidy(.x))
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
ggplot(aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
ggplot(aes(x = 8*timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = 8*timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
# Plot 1: Timecourse of pupil data
p1 <- dm_long %>%
filter(timepoint <= 494 & (stim_type == 'emphasized' | stim_type == 'emphasized_noise')) %>%
ggplot(aes(x = 8*timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size", x = '') +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = 8*timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value", x = 'Time since onset stimulus (ms)') +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
models_by_time <- dm_long %>%
filter(timepoint <= 494) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_grouped +
(1 + stim_grouped | participant) +
(1 | stim_type), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
models_by_time <- dm_long %>%
filter(timepoint <= 494) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_type +
(1 + stim_grouped | participant), data = .x)),
results = map(model, ~ tidy(.x, effects = "fixed"))  # Only fixed effects
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- ggplot(dm_long, aes(x = timepoint, y = pupil, group = index, colour = stim_grouped)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_grouped, colour = stim_grouped), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
# Plot 1: Timecourse of pupil data
p1 <- ggplot(dm_long, aes(x = timepoint, y = pupil, group = index, colour = stim_type)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_type, colour = stim_type), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic, color = term)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
View(stim_tvalues)
models_by_time <- dm_long %>%
filter(timepoint <= 494) %>%
group_by(timepoint) %>%
nest() %>%
mutate(
model = map(data, ~ lmer(pupil ~ stim_grouped +
(1 + stim_grouped || participant) +
(1 | trialnr), data = .x)),
results = map(model, tidy)
)
stim_tvalues <- models_by_time %>%
unnest(results) %>%
filter(term != "(Intercept)") %>%
select(timepoint, term, estimate, std.error, statistic)  # statistic = t-value
# Plot 1: Timecourse of pupil data
p1 <- ggplot(dm_long, aes(x = timepoint, y = pupil, group = index, colour = stim_grouped)) +
geom_line(alpha = 0.2) +
geom_smooth(aes(group = stim_grouped, colour = stim_grouped), se = FALSE, size = 1.2) +
labs(y = "Pupil size") +
theme_minimal()
# Plot 2: t-values over time
p2 <- ggplot(stim_tvalues, aes(x = timepoint, y = statistic)) +
geom_point() +
geom_hline(yintercept = c(-2, 2), linetype = "dashed", color = "red") +
geom_hline(yintercept = 0, linetype = "solid", color = "blue") +
labs(y = "t-value") +
theme_minimal()
# Combine vertically
(p1 / p2) + plot_layout(heights = c(0.7, 0.3))
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil), latency = timepoint[pupil == max(pupil)])
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(.x$pupil))
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil))
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil, na.rm = T))
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil, na.rm = T), latency = timepoint[pupil == max(pupil, na.rm=T)])
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil, na.rm = T), latency = .x$timepoint[pupil == max(pupil, na.rm=T)])
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil, na.rm = T), latency = timepoint)
# ==============================================================================
dm_long %>%
group_by(index) %>%
summarise(max_pupil_size = max(pupil, na.rm = T))
dm_long %>%
group_by(index) %>%
slice_max(pupil, n = 1, with_ties = FALSE) %>%
ungroup() %>%
select(index, max_pupil_size = pupil, timepoint)
dm_long %>%
group_by(index) %>%
slice_max(pupil, n = 3, with_ties = FALSE) %>%
ungroup() %>%
select(index, max_pupil = pupil, timepoint)
df_max_pupil <- dm_long %>%
group_by(index) %>%
slice_max(pupil, n = 3, with_ties = FALSE) %>%
ungroup() %>%
select(index, max_pupil = pupil, timepoint)
df_max_pupil <- dm_long %>%
group_by(index) %>%
slice_max(pupil, n = 3, with_ties = FALSE) %>%
ungroup() %>%
select(index, max_pupil = pupil, timepoint, stim_grouped, stim_type, participant, baseline)
ggplot(df_max_pupil, aes(x = index, y = max_pupil)) +
geom_point()
ggplot(df_max_pupil, aes(x = index, y = max_pupil)) +
geom_boxplot()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index)) +
geom_boxplot()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = index)) +
geom_boxplot()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = as.factor(index))) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = as.factor(index))) +
# geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = as.factor(index), show.legend=F)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = as.factor(index))) +
geom_boxplot() +
geom_point() +
theme(legend.position = 'none')
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = stim_type, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = stim_type, y = timepoint, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = timepoint, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = timepoint, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_point()
ggplot(df_max_pupil, aes(x = timepoint, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_point() +
geom_smooth()
kruskal.test(max_pupil ~ stim_type, data = df_max_pupil)
kruskal.test(max_pupil ~ stim_grouped, data = df_max_pupil)
df_max_pupil <- dm_long %>%
group_by(index) %>%
slice_max(pupil, n = 1, with_ties = FALSE) %>%
ungroup() %>%
select(index, max_pupil = pupil, timepoint, stim_grouped, stim_type, participant, baseline)
ggplot(df_max_pupil, aes(x = index, y = max_pupil, group = index, colour = as.factor(index))) +
geom_boxplot() +
geom_point() +
theme(legend.position = 'none')
ggplot(df_max_pupil, aes(x = stim_type, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = stim_type, y = timepoint, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
kruskal.test(max_pupil ~ stim_type, data = df_max_pupil)
kruskal.test(max_pupil ~ stim_grouped, data = df_max_pupil)
kruskal.test(timepoint ~ stim_type, data = df_max_pupil)
kruskal.test(timepoint ~ stim_grouped, data = df_max_pupil)
ggplot(df_max_pupil, aes(x = stim_grouped, y = max_pupil, group = stim_grouped, colour = stim_grouped)) +
geom_boxplot() +
geom_point()
ggplot(df_max_pupil, aes(x = stim_grouped, y = timepoint, group = stim_grouped, colour = stim_grouped)) +
geom_boxplot() +
geom_point()
pairwise.wilcox.test(df_max_pupil$max_pupil, df_max_pupil$stim_type,
p.adjust.method = "BH")
kruskal.test(max_pupil ~ stim_grouped, data = df_max_pupil)
kruskal.test(timepoint ~ stim_type, data = df_max_pupil)
kruskal.test(timepoint ~ stim_grouped, data = df_max_pupil)
pairwise.wilcox.test(df_max_pupil$timepoint, df_max_pupil$stim_grouped,
p.adjust.method = "BH")
wilcox.test(max_pupil ~ stim_grouped,
data = df_max_pupil,
exact = FALSE)
kruskal.test(max_pupil ~ stim_grouped, data = df_max_pupil)
wilcox.test(timepoint ~ stim_grouped,
data = df_max_pupil,
exact = FALSE)
pairwise.wilcox.test(df_max_pupil$max_pupil, df_max_pupil$stim_type,
p.adjust.method = "BH")
# difference in maximum pupil size for all different groups
kruskal.test(max_pupil ~ stim_type, data = df_max_pupil)
pairwise.wilcox.test(df_max_pupil$max_pupil, df_max_pupil$stim_type,
p.adjust.method = "BH")
ggplot(df_max_pupil, aes(x = stim_type, y = max_pupil, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
kruskal.test(timepoint ~ stim_type, data = df_max_pupil)
ggplot(df_max_pupil, aes(x = stim_type, y = timepoint, group = stim_type, colour = stim_type)) +
geom_boxplot() +
geom_point()
wilcox.test(max_pupil ~ stim_grouped,
data = df_max_pupil,
exact = FALSE)
ggplot(df_max_pupil, aes(x = stim_grouped, y = max_pupil, group = stim_grouped, colour = stim_grouped)) +
geom_boxplot() +
geom_point()
wilcox.test(timepoint ~ stim_grouped,
data = df_max_pupil,
exact = FALSE)
ggplot(df_max_pupil, aes(x = stim_grouped, y = timepoint, group = stim_grouped, colour = stim_grouped)) +
geom_boxplot() +
geom_point()
